<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>OrdinalMultinomialModels.jl · OrdinalMultinomialModels.jl</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>OrdinalMultinomialModels.jl</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>OrdinalMultinomialModels.jl</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Example-data"><span>Example data</span></a></li><li><a class="tocitem" href="#Syntax"><span>Syntax</span></a></li><li><a class="tocitem" href="#Fit-ordered-multinomial-models"><span>Fit ordered multinomial models</span></a></li><li><a class="tocitem" href="#Optimization-algorithms"><span>Optimization algorithms</span></a></li><li><a class="tocitem" href="#Likelihood-ratio-test-(LRT)"><span>Likelihood ratio test (LRT)</span></a></li><li><a class="tocitem" href="#Score-test"><span>Score test</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>OrdinalMultinomialModels.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>OrdinalMultinomialModels.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/OpenMendel/OrdinalMultinomialModels.jl/blob/master/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="OrdinalMultinomialModels.jl"><a class="docs-heading-anchor" href="#OrdinalMultinomialModels.jl">OrdinalMultinomialModels.jl</a><a id="OrdinalMultinomialModels.jl-1"></a><a class="docs-heading-anchor-permalink" href="#OrdinalMultinomialModels.jl" title="Permalink"></a></h1><p>OrdinalMultinomialModels.jl provides Julia utilities to fit ordered multinomial models, including <a href="https://en.wikipedia.org/wiki/Ordered_logit">proportional odds model</a> and <a href="https://en.wikipedia.org/wiki/Ordered_probit">ordered Probit model</a> as special cases. </p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>This package requires Julia v0.7 or later. The package has not yet been registered and must be installed using the repository location. Start julia and use the <code>]</code> key to switch to the package manager REPL</p><pre><code class="language-julia hljs">(v1.1) pkg&gt; add https://github.com/OpenMendel/OrdinalMultinomialModels.jl</code></pre><pre><code class="language-julia hljs"># Machine info for results in this tutorial
versioninfo()</code></pre><pre><code class="nohighlight hljs">Julia Version 1.1.0
Commit 80516ca202 (2019-01-21 21:24 UTC)
Platform Info:
  OS: macOS (x86_64-apple-darwin14.5.0)
  CPU: Intel(R) Core(TM) i7-6920HQ CPU @ 2.90GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-6.0.1 (ORCJIT, skylake)
Environment:
  JULIA_EDITOR = code</code></pre><pre><code class="language-julia hljs"># for use in this tutorial
using OrdinalMultinomialModels, BenchmarkTools, RDatasets</code></pre><h2 id="Example-data"><a class="docs-heading-anchor" href="#Example-data">Example data</a><a id="Example-data-1"></a><a class="docs-heading-anchor-permalink" href="#Example-data" title="Permalink"></a></h2><p><code>housing</code> is a data set from R package <a href="https://cran.r-project.org/web/packages/MASS/index.html">MASS</a>. The outcome of interest is <code>Sat</code> (satisfication) that takes values <code>Low</code>, <code>Medium</code>, or <code>High</code>. Predictors include <code>Infl</code> (inflation, categorical), <code>Type</code> (housing type, categorical), and <code>Cont</code> (categorical). <code>Freq</code> codes number of observation for each combination of levels.</p><pre><code class="language-julia hljs">housing = dataset(&quot;MASS&quot;, &quot;housing&quot;)</code></pre><p>&lt;table class=&quot;data-frame&quot;&gt;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;Sat&lt;/th&gt;&lt;th&gt;Infl&lt;/th&gt;&lt;th&gt;Type&lt;/th&gt;&lt;th&gt;Cont&lt;/th&gt;&lt;th&gt;Freq&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;&lt;/th&gt;&lt;th&gt;Categorical…&lt;/th&gt;&lt;th&gt;Categorical…&lt;/th&gt;&lt;th&gt;Categorical…&lt;/th&gt;&lt;th&gt;Categorical…&lt;/th&gt;&lt;th&gt;Int32&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;&lt;p&gt;72 rows × 5 columns&lt;/p&gt;&lt;tr&gt;&lt;th&gt;1&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Tower&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;21&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;2&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Tower&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;21&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;3&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Tower&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;28&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;4&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Tower&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;34&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;5&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Tower&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;22&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;6&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Tower&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;36&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;7&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Tower&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;10&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;8&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Tower&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;11&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;9&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Tower&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;36&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;10&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Apartment&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;61&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;11&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Apartment&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;23&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;12&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Apartment&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;17&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;13&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Apartment&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;43&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;14&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Apartment&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;35&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;15&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Apartment&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;40&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;16&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Apartment&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;26&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;17&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Apartment&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;18&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;18&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Apartment&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;54&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;19&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Atrium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;13&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;20&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Atrium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;21&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Atrium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;10&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;22&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Atrium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;8&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;23&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Atrium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;8&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;24&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Atrium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;12&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;25&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Atrium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;6&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;26&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Atrium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;27&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Atrium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;9&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;28&lt;/th&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Terrace&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;18&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;29&lt;/th&gt;&lt;td&gt;Medium&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Terrace&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;6&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;30&lt;/th&gt;&lt;td&gt;High&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;Terrace&lt;/td&gt;&lt;td&gt;Low&lt;/td&gt;&lt;td&gt;7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;&amp;vellip;&lt;/th&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;td&gt;&amp;vellip;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;</p><p>There are 72 unique combination of levels and the total number of observations is 1,681.</p><pre><code class="language-julia hljs">size(housing, 1), sum(housing[:Freq])</code></pre><pre><code class="nohighlight hljs">(72, 1681)</code></pre><h2 id="Syntax"><a class="docs-heading-anchor" href="#Syntax">Syntax</a><a id="Syntax-1"></a><a class="docs-heading-anchor-permalink" href="#Syntax" title="Permalink"></a></h2><p><code>polr</code> is the main function of fitting ordered multinomial model. For documentation, type <code>?polr</code> at Julia REPL.</p><article class="docstring"><header><a class="docstring-binding" id="OrdinalMultinomialModels.polr" href="#OrdinalMultinomialModels.polr"><code>OrdinalMultinomialModels.polr</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">polr(formula, df, link, solver=NLoptSolver(algorithm=:LD_SLSQP, maxeval=4000))
polr(X, y, link, solver=NLoptSolver(algorithm=:LD_SLSQP, maxeval=4000))</code></pre><p>Fit ordered multinomial model by maximum likelihood estimation.</p><p><strong>Positional arguments</strong></p><ul><li><code>formula::Formula</code>: a model formula specifying responses and regressors.</li><li><code>df::DataFrame</code>: a dataframe. Response variable should take integer values    starting from 1.</li><li><code>y::Vector</code>: integer vector taking values in <code>1,...,J</code>.</li><li><code>X::Matrix</code>: <code>n x p</code> covariate matrix excluding intercept.</li><li><code>link::GLM.Link</code>: <code>LogitLink()</code> (default), <code>ProbitLink()</code>, <code>CauchitLink()</code>, or <code>CloglogLink()</code>.</li><li><code>solver</code>: An instance of <code>Ipopt.Optimizer()</code> or <code>NLopt.Optimizer()</code> (default).</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>wts::AbstractVector=similar(X, 0)</code>: observation weights.</li></ul><p><strong>Output</strong></p><ul><li><code>dd:PolrModel</code>: a <code>PolrModel</code> type.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenMendel/OrdinalMultinomialModels.jl/blob/4fe6e8257394faaf3400ba654ef3a5d687ab0eff/src/ordmnfit.jl#L138-L158">source</a></section></article><h2 id="Fit-ordered-multinomial-models"><a class="docs-heading-anchor" href="#Fit-ordered-multinomial-models">Fit ordered multinomial models</a><a id="Fit-ordered-multinomial-models-1"></a><a class="docs-heading-anchor-permalink" href="#Fit-ordered-multinomial-models" title="Permalink"></a></h2><h3 id="Proportional-odds-model"><a class="docs-heading-anchor" href="#Proportional-odds-model">Proportional odds model</a><a id="Proportional-odds-model-1"></a><a class="docs-heading-anchor-permalink" href="#Proportional-odds-model" title="Permalink"></a></h3><p>To fit an ordered multinomial model using default link <code>link=LogitLink()</code>, i.e., proportional odds model</p><pre><code class="language-julia hljs">house_po = polr(@formula(Sat ~ Infl + Type + Cont), housing, wts = housing[:Freq])</code></pre><pre><code class="nohighlight hljs">StatsModels.DataFrameRegressionModel{OrdinalMultinomialModel{Int64,Float64,LogitLink},Array{Float64,2}}

Formula: Sat ~ Infl + Type + Cont

Coefficients:
                  Estimate Std.Error  t value Pr(&gt;|t|)
intercept1|2     -0.496141  0.124541 -3.98376   0.0002
intercept2|3      0.690706  0.125212  5.51628    &lt;1e-6
Infl: Medium      0.566392  0.104963  5.39611    &lt;1e-5
Infl: High         1.28881  0.126705  10.1718   &lt;1e-14
Type: Apartment  -0.572352  0.118747 -4.81991    &lt;1e-5
Type: Atrium     -0.366182  0.156766 -2.33586   0.0226
Type: Terrace     -1.09101  0.151514 -7.20075    &lt;1e-9
Cont: High        0.360284 0.0953574  3.77825   0.0003</code></pre><p>Since there are <span>$J=3$</span> categories in <code>Sat</code>, the fitted model has 2 intercept parameters <span>$\theta_1$</span> and <span>$\theta_2$</span> that satisfy <span>$\theta_1 \le \theta_2$</span>. <span>$\beta_1, \beta_2$</span> are regression coefficients for <code>Infl</code> (3 levels), <span>$\beta_3, \beta_4, \beta_5$</span> for <code>Type</code> (4 levels), and <span>$\beta_6$</span> for <code>Cont</code> (2 levels). </p><p>Deviance (-2 loglikelihood) of the fitted model is</p><pre><code class="language-julia hljs">deviance(house_po)</code></pre><pre><code class="nohighlight hljs">3479.149299072586</code></pre><p>Estimated regression coefficients are</p><pre><code class="language-julia hljs">coef(house_po)</code></pre><pre><code class="nohighlight hljs">8-element Array{Float64,1}:
 -0.4961406134145464 
  0.6907056439400198 
  0.5663915864515743 
  1.288810825003427  
 -0.5723518911944654 
 -0.36618227185604263
 -1.0910115747375622 
  0.36028444175284197</code></pre><p>with standard errors</p><pre><code class="language-julia hljs">stderror(house_po)</code></pre><pre><code class="nohighlight hljs">8-element Array{Float64,1}:
 0.12454076603722913
 0.1252121074560087 
 0.10496298447216806
 0.1267047666889804 
 0.11874734570694132
 0.1567658347801272 
 0.15151363694373737
 0.09535742939732537</code></pre><h3 id="Ordered-probit-model"><a class="docs-heading-anchor" href="#Ordered-probit-model">Ordered probit model</a><a id="Ordered-probit-model-1"></a><a class="docs-heading-anchor-permalink" href="#Ordered-probit-model" title="Permalink"></a></h3><p>To fit an ordered probit model, we use link <code>ProbitLink()</code></p><pre><code class="language-julia hljs">house_op = polr(@formula(Sat ~ Infl + Type + Cont), housing, ProbitLink(), wts = housing[:Freq])</code></pre><pre><code class="nohighlight hljs">StatsModels.DataFrameRegressionModel{OrdinalMultinomialModel{Int64,Float64,ProbitLink},Array{Float64,2}}

Formula: Sat ~ Infl + Type + Cont

Coefficients:
                  Estimate Std.Error  t value Pr(&gt;|t|)
intercept1|2     -0.299829 0.0761614 -3.93676   0.0002
intercept2|3       0.42672 0.0763991   5.5854    &lt;1e-6
Infl: Medium      0.346423 0.0641796  5.39771    &lt;1e-5
Infl: High        0.782914 0.0762645  10.2658   &lt;1e-14
Type: Apartment  -0.347538 0.0722116 -4.81278    &lt;1e-5
Type: Atrium     -0.217889 0.0955741 -2.27979   0.0260
Type: Terrace    -0.664175 0.0919294 -7.22484    &lt;1e-9
Cont: High        0.222386 0.0581214  3.82624   0.0003</code></pre><pre><code class="language-julia hljs">deviance(house_op)</code></pre><pre><code class="nohighlight hljs">3479.6888425652414</code></pre><h3 id="Proportional-hazards-model"><a class="docs-heading-anchor" href="#Proportional-hazards-model">Proportional hazards model</a><a id="Proportional-hazards-model-1"></a><a class="docs-heading-anchor-permalink" href="#Proportional-hazards-model" title="Permalink"></a></h3><p>To fit a proportional hazards model, we use <code>CloglogLink()</code></p><pre><code class="language-julia hljs">house_ph = polr(@formula(Sat ~ Infl + Type + Cont), housing, CloglogLink(), wts = housing[:Freq])</code></pre><pre><code class="nohighlight hljs">StatsModels.DataFrameRegressionModel{OrdinalMultinomialModel{Int64,Float64,CloglogLink},Array{Float64,2}}

Formula: Sat ~ Infl + Type + Cont

Coefficients:
                  Estimate Std.Error  t value Pr(&gt;|t|)
intercept1|2     -0.796225 0.0904739  -8.8006   &lt;1e-11
intercept2|3     0.0553535 0.0866662 0.638697   0.5253
Infl: Medium      0.382045 0.0701219  5.44829    &lt;1e-6
Infl: High        0.915384 0.0924967  9.89639   &lt;1e-13
Type: Apartment  -0.407228 0.0861331 -4.72789    &lt;1e-4
Type: Atrium      -0.28056  0.112949 -2.48396   0.0156
Type: Terrace    -0.742481  0.102084 -7.27321    &lt;1e-9
Cont: High        0.209235 0.0653756   3.2005   0.0021</code></pre><pre><code class="language-julia hljs">deviance(house_ph)</code></pre><pre><code class="nohighlight hljs">3484.0531705626904</code></pre><p>From the deviances, we see that the proportional odds model (logit link) has the best fit among all three models.</p><pre><code class="language-julia hljs">deviance(house_po), deviance(house_op), deviance(house_ph)</code></pre><pre><code class="nohighlight hljs">(3479.149299072586, 3479.6888425652414, 3484.0531705626904)</code></pre><h3 id="Alternative-syntax-without-using-DataFrame"><a class="docs-heading-anchor" href="#Alternative-syntax-without-using-DataFrame">Alternative syntax without using DataFrame</a><a id="Alternative-syntax-without-using-DataFrame-1"></a><a class="docs-heading-anchor-permalink" href="#Alternative-syntax-without-using-DataFrame" title="Permalink"></a></h3><p>An alternative syntax is useful when it is inconvenient to use DataFrame</p><pre><code class="language-julia hljs">polr(X, y, link, solver; wts)</code></pre><p>where <code>y</code> is the response vector and <code>X</code> is the <code>n x p</code> predictor matrix <strong>excluding</strong> intercept.</p><h2 id="Optimization-algorithms"><a class="docs-heading-anchor" href="#Optimization-algorithms">Optimization algorithms</a><a id="Optimization-algorithms-1"></a><a class="docs-heading-anchor-permalink" href="#Optimization-algorithms" title="Permalink"></a></h2><p>PolrModels.jl relies on nonlinear programming (NLP) optimization algorithms to find the maximum likelihood estimate (MLE). User can input any solver supported by the MathProgBase.jl package (see <a href="http://www.juliaopt.org">http://www.juliaopt.org</a>) as the 4th argument of <code>polr</code> function. Common choices are:  </p><ul><li>Ipopt solver: <code>IpoptSolver(print_level=0)</code>. See <a href="https://github.com/JuliaOpt/Ipopt.jl">Ipopt.jl</a> for numerous arugments to <code>IpoptSolver</code>. For example, setting <code>print_level=5</code> is useful for diagnosis purpose.   </li><li><a href="https://github.com/JuliaOpt/NLopt.jl">NLopt package</a>: <code>NLoptSolver(algorithm=:LD_SLSQP)</code>, <code>NLoptSolver(algorithm=:LD_LBFGS)</code>. See <a href="https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/">NLopt algorithms</a> for all algorithms in <a href="https://github.com/JuliaOpt/NLopt.jl">NLopt.jl</a>.</li></ul><p>When optimization fails, user can always try another algorithm.</p><p>Use Ipopt (interior-point) solver</p><pre><code class="language-julia hljs">polr(@formula(Sat ~ Infl + Type + Cont), housing, LogitLink(), 
    IpoptSolver(print_level=3); wts = housing[:Freq])</code></pre><pre><code class="nohighlight hljs">******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************

Total number of variables............................:        8
                     variables with only lower bounds:        0
                variables with lower and upper bounds:        0
                     variables with only upper bounds:        0
Total number of equality constraints.................:        0
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0


Number of Iterations....: 38

                                   (scaled)                 (unscaled)
Objective...............:   2.0594068522767617e+02    1.7395746495294738e+03
Dual infeasibility......:   8.1478360269928591e-09    6.8824520931403241e-08
Constraint violation....:   0.0000000000000000e+00    0.0000000000000000e+00
Complementarity.........:   0.0000000000000000e+00    0.0000000000000000e+00
Overall NLP error.......:   8.1478360269928591e-09    6.8824520931403241e-08


Number of objective function evaluations             = 91
Number of objective gradient evaluations             = 39
Number of equality constraint evaluations            = 0
Number of inequality constraint evaluations          = 0
Number of equality constraint Jacobian evaluations   = 0
Number of inequality constraint Jacobian evaluations = 0
Number of Lagrangian Hessian evaluations             = 0
Total CPU secs in IPOPT (w/o function evaluations)   =      0.050
Total CPU secs in NLP function evaluations           =      0.006

EXIT: Optimal Solution Found.





StatsModels.DataFrameRegressionModel{OrdinalMultinomialModel{Int64,Float64,LogitLink},Array{Float64,2}}

Formula: Sat ~ Infl + Type + Cont

Coefficients:
                  Estimate Std.Error  t value Pr(&gt;|t|)
intercept1|2     -0.496135  0.124541 -3.98372   0.0002
intercept2|3      0.690708  0.125212   5.5163    &lt;1e-6
Infl: Medium      0.566394  0.104963  5.39613    &lt;1e-5
Infl: High         1.28882  0.126705  10.1718   &lt;1e-14
Type: Apartment   -0.57235  0.118747  -4.8199    &lt;1e-5
Type: Atrium     -0.366186  0.156766 -2.33588   0.0226
Type: Terrace     -1.09101  0.151514 -7.20077    &lt;1e-9
Cont: High        0.360284 0.0953575  3.77825   0.0003</code></pre><p>Use SLSQP (sequential quadratic programming) in NLopt.jl package</p><pre><code class="language-julia hljs">polr(@formula(Sat ~ Infl + Type + Cont), housing, LogitLink(), 
    NLoptSolver(algorithm=:LD_SLSQP); wts = housing[:Freq])</code></pre><pre><code class="nohighlight hljs">StatsModels.DataFrameRegressionModel{OrdinalMultinomialModel{Int64,Float64,LogitLink},Array{Float64,2}}

Formula: Sat ~ Infl + Type + Cont

Coefficients:
                  Estimate Std.Error  t value Pr(&gt;|t|)
intercept1|2     -0.496141  0.124541 -3.98376   0.0002
intercept2|3      0.690706  0.125212  5.51628    &lt;1e-6
Infl: Medium      0.566392  0.104963  5.39611    &lt;1e-5
Infl: High         1.28881  0.126705  10.1718   &lt;1e-14
Type: Apartment  -0.572352  0.118747 -4.81991    &lt;1e-5
Type: Atrium     -0.366182  0.156766 -2.33586   0.0226
Type: Terrace     -1.09101  0.151514 -7.20075    &lt;1e-9
Cont: High        0.360284 0.0953574  3.77825   0.0003</code></pre><p>Use LBFGS (quasi-Newton algorithm) in NLopt.jl package</p><pre><code class="language-julia hljs">polr(@formula(Sat ~ 0 + Infl + Type + Cont), housing, LogitLink(), 
    NLoptSolver(algorithm=:LD_LBFGS); wts = housing[:Freq])</code></pre><pre><code class="nohighlight hljs">StatsModels.DataFrameRegressionModel{OrdinalMultinomialModel{Int64,Float64,LogitLink},Array{Float64,2}}

Formula: Sat ~ Infl + Type + Cont

Coefficients:
                  Estimate Std.Error  t value Pr(&gt;|t|)
intercept1|2     -0.496111  0.124541 -3.98353   0.0002
intercept2|3      0.690732  0.125212  5.51649    &lt;1e-6
Infl: Medium      0.566394  0.104963  5.39613    &lt;1e-5
Infl: High         1.28882  0.126705  10.1718   &lt;1e-14
Type: Apartment  -0.572352  0.118747 -4.81991    &lt;1e-5
Type: Atrium      -0.36616  0.156766 -2.33571   0.0227
Type: Terrace     -1.09102  0.151514  -7.2008    &lt;1e-9
Cont: High        0.360319 0.0953575  3.77861   0.0003</code></pre><h2 id="Likelihood-ratio-test-(LRT)"><a class="docs-heading-anchor" href="#Likelihood-ratio-test-(LRT)">Likelihood ratio test (LRT)</a><a id="Likelihood-ratio-test-(LRT)-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood-ratio-test-(LRT)" title="Permalink"></a></h2><p><code>polr</code> function calculates the Wald test (or t-test) p-value for each predictor in the model. To carry out the potentially more powerful likelihood ratio test (LRT), we need to fill the null and alternative models separately.</p><p><strong>Step 1</strong>: Fit the null model with only <code>Infl</code> and <code>Type</code> factors.</p><pre><code class="language-julia hljs">house_null = polr(@formula(Sat ~ Infl + Type), housing; wts = housing[:Freq])</code></pre><pre><code class="nohighlight hljs">StatsModels.DataFrameRegressionModel{OrdinalMultinomialModel{Int64,Float64,LogitLink},Array{Float64,2}}

Formula: Sat ~ Infl + Type

Coefficients:
                  Estimate Std.Error  t value Pr(&gt;|t|)
intercept1|2     -0.672949  0.115559 -5.82341    &lt;1e-6
intercept2|3      0.505629  0.115147  4.39116    &lt;1e-4
Infl: Medium      0.548392  0.104613  5.24213    &lt;1e-5
Infl: High          1.2373  0.125448  9.86306   &lt;1e-13
Type: Apartment  -0.521441  0.117616 -4.43341    &lt;1e-4
Type: Atrium     -0.289347  0.155074 -1.86587   0.0666
Type: Terrace     -1.01404   0.14976  -6.7711    &lt;1e-8</code></pre><p><strong>Step 2</strong>: To test significance of the <code>Cont</code> variable, we use <code>polrtest</code> function. The first argument is the fitted null model, the second argument is the predictor vector to be tested</p><pre><code class="language-julia hljs"># last column of model matrix is coding for Cont (2-level factor)
cont = modelmatrix(house_po.model)[:, end]
# calculate p-value
polrtest(house_null, cont; test=:LRT)</code></pre><pre><code class="nohighlight hljs">0.000155351855453278</code></pre><h2 id="Score-test"><a class="docs-heading-anchor" href="#Score-test">Score test</a><a id="Score-test-1"></a><a class="docs-heading-anchor-permalink" href="#Score-test" title="Permalink"></a></h2><p>User can perform <strong>score test</strong> using the <code>polrtest</code> function too. Score test has the advantage that, when testing a huge number of predictors such as in genomewide association studies (GWAS), one only needs to fit the null model once and then testing each predictor is cheap. Both Wald and likelihood ratio test (LRT) need to fit a separate alternative model for each predictor being tested.</p><p><strong>Step 1</strong>: Fit the null model with only <code>Infl</code> and <code>Type</code> factors.</p><pre><code class="language-julia hljs">house_null = polr(@formula(Sat ~ Infl + Type), housing; wts = housing[:Freq])</code></pre><pre><code class="nohighlight hljs">StatsModels.DataFrameRegressionModel{OrdinalMultinomialModel{Int64,Float64,LogitLink},Array{Float64,2}}

Formula: Sat ~ Infl + Type

Coefficients:
                  Estimate Std.Error  t value Pr(&gt;|t|)
intercept1|2     -0.672949  0.115559 -5.82341    &lt;1e-6
intercept2|3      0.505629  0.115147  4.39116    &lt;1e-4
Infl: Medium      0.548392  0.104613  5.24213    &lt;1e-5
Infl: High          1.2373  0.125448  9.86306   &lt;1e-13
Type: Apartment  -0.521441  0.117616 -4.43341    &lt;1e-4
Type: Atrium     -0.289347  0.155074 -1.86587   0.0666
Type: Terrace     -1.01404   0.14976  -6.7711    &lt;1e-8</code></pre><p><strong>Step 2</strong>: To test significance of the <code>Cont</code> variable, we use <code>polrtest</code> function. The first argument is the fitted null model, the second argument is the predictor vector to be tested</p><pre><code class="language-julia hljs"># last column of model matrix is coding for Cont (2-level factor)
cont = modelmatrix(house_po.model)[:, end]
# calculate p-value
polrtest(house_null, cont; test=:score)</code></pre><pre><code class="nohighlight hljs">0.0001648743597587817</code></pre><p><strong>Step 3</strong>: Now suppose we want to test significance of another predictor, <code>z1</code>. We just need to call <code>polrtest</code> with <code>z1</code> and the same fiited null model. No model fitting is needed.</p><p>For demonstration purpose, we generate <code>z1</code> randomly. The score test p-value of <code>z1</code> is, not suprisingly, large.</p><pre><code class="language-julia hljs">z1 = randn(nobs(house_null))
polrtest(house_null, z1)</code></pre><pre><code class="nohighlight hljs">0.1673512522966108</code></pre><p><strong>Step 4</strong>: We can also test a set of precitors or a factor.</p><pre><code class="language-julia hljs">z3 = randn(nobs(house_null), 3)
polrtest(house_null, z3)</code></pre><pre><code class="nohighlight hljs">6.709335149358069e-10</code></pre></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 14 October 2022 03:03">Friday 14 October 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
